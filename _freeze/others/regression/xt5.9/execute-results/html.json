{
  "hash": "13e24192dfec38af10ab40a83da54587",
  "result": {
    "markdown": "---\ntitle: 习题5.9\nfig-height: 3\nfig-width: 5\ndescription: 自变量选择与逐步回归\n---\n\n> **数据如下表。由定性分析知。所选自变量都与因变量$y$由较强的相关性，分别用后退法和逐步回归法做自变量选元。**\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haven)\ndata = read_sav(\"data/xt5.9.sav\")\nhead(data)\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 6 × 8\n   年份    x1    x2    x3     x4    x5    x6     y\n  <dbl> <dbl> <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl>\n1  1978 1018. 1607   138.  96259 2239. 50760 1132.\n2  1979 1259. 1770.  144.  97542 2619. 39370 1146.\n3  1980 1359. 1996.  196.  98705 2976. 44530 1160.\n4  1981 1546. 2048.  207. 100072 3309. 39790 1176.\n5  1982 1762. 2162.  221. 101654 3638. 33130 1212.\n6  1983 1961. 2376.  271. 103008 4020. 34710 1367.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 建立模型\nmodel = lm(y ~., data[, -1])\nsummary(model)\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ ., data = data[, -1])\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-374.18  -82.44   -3.00   91.05  237.52 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.348e+03  2.211e+03   0.610 0.551859    \nx1          -6.410e-01  1.669e-01  -3.840 0.001804 ** \nx2          -3.170e-01  2.044e-01  -1.551 0.143216    \nx3          -4.127e-01  5.485e-01  -0.752 0.464294    \nx4          -2.110e-03  2.428e-02  -0.087 0.931962    \nx5           6.711e-01  1.280e-01   5.241 0.000125 ***\nx6          -7.541e-03  8.128e-03  -0.928 0.369220    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 191.8 on 14 degrees of freedom\nMultiple R-squared:  0.9962,\tAdjusted R-squared:  0.9946 \nF-statistic:   618 on 6 and 14 DF,  p-value: 3.81e-16\n```\n:::\n:::\n\n**后退法**\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_back = step(model, direction=\"backward\", trace=0)\nsummary(model_back)\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ x1 + x2 + x5, data = data[, -1])\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-372.27 -102.79   -7.78  157.94  313.69 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 874.58627  106.86620   8.184 2.67e-07 ***\nx1           -0.61116    0.12382  -4.936 0.000125 ***\nx2           -0.35304    0.08840  -3.994 0.000940 ***\nx5            0.63669    0.08914   7.142 1.65e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 183.1 on 17 degrees of freedom\nMultiple R-squared:  0.9958,\tAdjusted R-squared:  0.9951 \nF-statistic:  1356 on 3 and 17 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n**逐步回归法**\n\n::: {.cell}\n\n```{.r .cell-code}\n# 逐步回归法\nmodel_both = step(model, direction=\"both\", trace=0)\nsummary(model_both)\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ x1 + x2 + x5, data = data[, -1])\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-372.27 -102.79   -7.78  157.94  313.69 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 874.58627  106.86620   8.184 2.67e-07 ***\nx1           -0.61116    0.12382  -4.936 0.000125 ***\nx2           -0.35304    0.08840  -3.994 0.000940 ***\nx5            0.63669    0.08914   7.142 1.65e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 183.1 on 17 degrees of freedom\nMultiple R-squared:  0.9958,\tAdjusted R-squared:  0.9951 \nF-statistic:  1356 on 3 and 17 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n答：后退法与逐步回归法所保留的变量相同。最终都得到回归方程：$\\hat{y}=874.6-0.611x_1-0.353x_2+0.637x_5$。但是回归系数的解释不合理。",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": [],
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}