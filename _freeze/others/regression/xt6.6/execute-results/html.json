{
  "hash": "0d0f49cddd4a9c93200554acf35d06f7",
  "result": {
    "markdown": "---\ntitle: 习题6.6\nfig-height: 3\nfig-width: 5\ndescription: 多重共线性的情形及其处理\n---\n\n> **数据如下表。分析数据的多重共线性，并根据多重共线性剔除变量，将所得结果与用逐步回归法所得的选元结果相比较。**\n\n#### 判断多重共线性\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haven)\ndata = read_sav(\"data/xt5.9.sav\")\nhead(data)\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 6 × 8\n   年份    x1    x2    x3     x4    x5    x6     y\n  <dbl> <dbl> <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl>\n1  1978 1018. 1607   138.  96259 2239. 50760 1132.\n2  1979 1259. 1770.  144.  97542 2619. 39370 1146.\n3  1980 1359. 1996.  196.  98705 2976. 44530 1160.\n4  1981 1546. 2048.  207. 100072 3309. 39790 1176.\n5  1982 1762. 2162.  221. 101654 3638. 33130 1212.\n6  1983 1961. 2376.  271. 103008 4020. 34710 1367.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 建立模型\nmodel = lm(y ~., data[, -1])\nsummary(model)\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ ., data = data[, -1])\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-374.18  -82.44   -3.00   91.05  237.52 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.348e+03  2.211e+03   0.610 0.551859    \nx1          -6.410e-01  1.669e-01  -3.840 0.001804 ** \nx2          -3.170e-01  2.044e-01  -1.551 0.143216    \nx3          -4.127e-01  5.485e-01  -0.752 0.464294    \nx4          -2.110e-03  2.428e-02  -0.087 0.931962    \nx5           6.711e-01  1.280e-01   5.241 0.000125 ***\nx6          -7.541e-03  8.128e-03  -0.928 0.369220    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 191.8 on 14 degrees of freedom\nMultiple R-squared:  0.9962,\tAdjusted R-squared:  0.9946 \nF-statistic:   618 on 6 and 14 DF,  p-value: 3.81e-16\n```\n:::\n:::\n\n**方差扩大因子法**\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nvif(model)\n```\n\n::: {.cell-output-stdout}\n```\n         x1          x2          x3          x4          x5          x6 \n 319.484477 2636.564359  479.287849   27.177337 1860.726476    1.742651 \n```\n:::\n:::\n\n**特征根判定法**\n\n::: {.cell}\n\n```{.r .cell-code}\nCor = cor(data[, 2:7])\nkappa(Cor, exact=TRUE)\n```\n\n::: {.cell-output-stdout}\n```\n[1] 21642.62\n```\n:::\n:::\n\n答：方差扩大因子$VIF_2=2636$远大于10，条件数k=21642远大于1000，说明自变量间存在严重的多重共线性。\n\n#### 消除多重共线性\n\n*剔除方差扩大因子最大的$x_2$，重新建立回归方程*\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2 = lm(y ~ x1 + x3 + x4 + x5 + x6, data)\nsummary(model2)\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ x1 + x3 + x4 + x5 + x6, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-376.09 -103.03  -36.15  113.64  301.70 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -1.253e+03  1.508e+03  -0.831 0.419165    \nx1          -7.354e-01  1.626e-01  -4.524 0.000403 ***\nx3          -9.233e-01  4.588e-01  -2.012 0.062495 .  \nx4           2.639e-02  1.659e-02   1.591 0.132532    \nx5           5.098e-01  7.809e-02   6.528 9.56e-06 ***\nx6          -1.052e-02  8.259e-03  -1.274 0.221998    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 200.6 on 15 degrees of freedom\nMultiple R-squared:  0.9956,\tAdjusted R-squared:  0.9941 \nF-statistic: 677.6 on 5 and 15 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nvif(model2)\n```\n\n::: {.cell-output-stdout}\n```\n        x1         x3         x4         x5         x6 \n276.968819 306.617361  11.605489 632.895698   1.645146 \n```\n:::\n:::\n\n*$VIF_5=632.896>10$，再剔除$x_5$建立回归方程*\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel3 = lm(y ~ x1 + x3 + x4 + x6, data)\nsummary(model3)\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ x1 + x3 + x4 + x6, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-611.00 -112.86  -14.74  172.65  888.36 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)  \n(Intercept) -2.715e+03  2.829e+03  -0.960   0.3516  \nx1          -4.738e-02  2.348e-01  -0.202   0.8426  \nx3           1.463e+00  5.260e-01   2.781   0.0133 *\nx4           3.637e-02  3.135e-02   1.160   0.2630  \nx6           3.125e-03  1.516e-02   0.206   0.8393  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 380.7 on 16 degrees of freedom\nMultiple R-squared:  0.9831,\tAdjusted R-squared:  0.9788 \nF-statistic: 232.3 on 4 and 16 DF,  p-value: 5.979e-14\n```\n:::\n\n```{.r .cell-code}\nvif(model3)\n```\n\n::: {.cell-output-stdout}\n```\n        x1         x3         x4         x6 \n160.512580 111.949275  11.507017   1.539699 \n```\n:::\n:::\n\n*$VIF_1=160.513>10$，再剔除$x_1$建立回归方程*\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel4 = lm(y ~ x3 + x4 + x6, data)\nsummary(model4)\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ x3 + x4 + x6, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-628.52 -109.40   -0.69  165.52  913.37 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2.296e+03  1.870e+03  -1.228    0.236    \nx3           1.359e+00  9.681e-02  14.036 8.84e-11 ***\nx4           3.143e-02  1.906e-02   1.649    0.117    \nx6           3.702e-03  1.446e-02   0.256    0.801    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 369.8 on 17 degrees of freedom\nMultiple R-squared:  0.983,\tAdjusted R-squared:   0.98 \nF-statistic: 328.2 on 3 and 17 DF,  p-value: 3.055e-15\n```\n:::\n\n```{.r .cell-code}\nvif(model4)\n```\n\n::: {.cell-output-stdout}\n```\n      x3       x4       x6 \n4.018087 4.508706 1.484981 \n```\n:::\n:::\n\n答：直至现在，所有自变量的方差扩大因子都已小于10，多重共线性已消除。但变量$x_6$的t检验P值=0.901>0.05未通过检验，遂将其剔除，再次建立回归模型。\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel5 = lm(y ~ x3 + x4, data)\nsummary(model5)\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ x3 + x4, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-643.14 -105.66   -4.29  168.60  908.91 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2.307e+03  1.820e+03  -1.267   0.2212    \nx3           1.359e+00  9.426e-02  14.415  2.5e-11 ***\nx4           3.304e-02  1.752e-02   1.886   0.0755 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 360.1 on 18 degrees of freedom\nMultiple R-squared:  0.983,\tAdjusted R-squared:  0.9811 \nF-statistic: 519.3 on 2 and 18 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n答：新的回归模型中，变量$x_4$的t检验P值=0.076，显著性较弱，但选择保留。回归方程为：$\\hat{y} = -2.307\\times 10^3+1.359x_3+3.304\\times 10^{-2}x_4$。可以看出，在本题中，根据方差扩大因子法所剔除的变量正是后退法和逐步回归法所保留的变量。\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": [],
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}