{
  "hash": "0607fb7dddf8dba8bb36139debd10f05",
  "result": {
    "markdown": "---\ntitle: 习题3.11\nfig-height: 3\nfig-width: 5\ndescription: 多元线性回归\n---\n\n> **题目：研究货运总量$y$（万吨）与工业总产值$x_1$（亿元）、农业总产值$x_2$（亿元）、居民非商品支出$x_3$（亿元）的关系。数据如下表所示。**\n\n::: {.cell}\n\n```{.r .cell-code}\n# 课本数据有10行，数据集不知何故多出一行\nlibrary(haven)\ndata = read_sav(\"data/xt3.11.sav\")[-11, ]\nhead(data)\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 6 × 4\n      Y    X1    X2    X3\n  <dbl> <dbl> <dbl> <dbl>\n1   160    70    35   1  \n2   260    75    40   2.4\n3   210    65    40   2  \n4   265    74    42   3  \n5   240    72    38   1.2\n6   220    68    45   1.5\n```\n:::\n:::\n\n#### 1. 计算出$y$，$x_1$，$x_2$，$x_3$的相关系数矩阵。\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(data)\n```\n\n::: {.cell-output-stdout}\n```\n           Y        X1        X2        X3\nY  1.0000000 0.5556527 0.7306199 0.7235354\nX1 0.5556527 1.0000000 0.1129513 0.3983870\nX2 0.7306199 0.1129513 1.0000000 0.5474739\nX3 0.7235354 0.3983870 0.5474739 1.0000000\n```\n:::\n:::\n\n#### 2. 求$y$关于$x_1$，$x_2$，$x_3$的三元线性方程\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel0 = lm(Y ~ X1 + X2 + X3, data)\nmodel0\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = Y ~ X1 + X2 + X3, data = data)\n\nCoefficients:\n(Intercept)           X1           X2           X3  \n   -348.280        3.754        7.101       12.447  \n```\n:::\n:::\n\n答：回归方程为：$\\hat{y} = -348.28+3.754x_1 + 7.101x_2 + 12.447x_3$。\n\n#### 3. 对所求得的方程做拟合优度检验\n\n::: {.cell}\n\n```{.r .cell-code}\nSm0 = summary(model0)\nSm0$r.squared\n```\n\n::: {.cell-output-stdout}\n```\n[1] 0.8055077\n```\n:::\n:::\n\n答：$R^2=0.8055$，接近1，说明方程拟合程度较好。\n\n#### 4. 对回归方程做显著性检验\n\n::: {.cell}\n\n```{.r .cell-code}\n# $运算符仅能提取F检验值，而未找到提取F检验P值的办法\n# 其位于summary函数输出的最后一行\nSm0\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = Y ~ X1 + X2 + X3, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.198 -17.035   2.627  11.677  33.225 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)  \n(Intercept) -348.280    176.459  -1.974   0.0959 .\nX1             3.754      1.933   1.942   0.1002  \nX2             7.101      2.880   2.465   0.0488 *\nX3            12.447     10.569   1.178   0.2835  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 23.44 on 6 degrees of freedom\nMultiple R-squared:  0.8055,\tAdjusted R-squared:  0.7083 \nF-statistic: 8.283 on 3 and 6 DF,  p-value: 0.01487\n```\n:::\n:::\n\n答：F检验的P值=0.01487<0.05，说明回归方程显著。\n\n#### 5. 对每一个回归系数做显著性检验\n\n::: {.cell}\n\n```{.r .cell-code}\nSm0$coefficients\n```\n\n::: {.cell-output-stdout}\n```\n               Estimate Std. Error   t value   Pr(>|t|)\n(Intercept) -348.280169 176.459221 -1.973715 0.09585537\nX1             3.754037   1.933315  1.941761 0.10019691\nX2             7.100712   2.880281  2.465284 0.04876860\nX3            12.447470  10.569330  1.177697 0.28350986\n```\n:::\n:::\n\n答：对各回归系数t检验中，$x_1$、$x_3$相应P值<0.5。在显著性水平5%情况下拒绝原假设，说明$x_1$、$x_3$对预测值$y$没有显著影响。\n\n#### 6. 如果有的回归系数没通过显著性检验，将其剔除，重新建立回归方程，再做方程的显著性检验和回归系数的显著性检验\n\n::: {.cell}\n\n```{.r .cell-code}\n# 由上题结果P值大小，剔除X3\nmodel1 = lm(Y ~ X1 + X2, data)\nSm1 = summary(model1)\nSm1\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = Y ~ X1 + X2, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-42.012 -10.656   4.358  11.984  28.927 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept) -459.624    153.058  -3.003  0.01986 * \nX1             4.676      1.816   2.575  0.03676 * \nX2             8.971      2.468   3.634  0.00835 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 24.08 on 7 degrees of freedom\nMultiple R-squared:  0.7605,\tAdjusted R-squared:  0.6921 \nF-statistic: 11.12 on 2 and 7 DF,  p-value: 0.006718\n```\n:::\n:::\n\n答：剔除$x_3$后，重新建立的回归方程为：$\\hat{y}=-459.624+4.676x_1+8.971x_2$。各回归系数相应P值皆小于0.05，即都通过显著性检验。\n\n#### 7. 求出每一个回归系数的置信水平为95%的置信区间\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint(model1)\n```\n\n::: {.cell-output-stdout}\n```\n                   2.5 %     97.5 %\n(Intercept) -821.5473012 -97.700006\nX1             0.3813047   8.969956\nX2             3.1339785  14.807944\n```\n:::\n:::\n\n答：$\\hat{\\beta}_0$、$\\hat{\\beta}_1$、$\\hat{\\beta}_2$的95%置信区间分别为：(-821.55, -97.70)、(0.38, 8.97)和(3.13,14.81)。\n\n#### 8. 求标准化回归方程\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2 = lm(scale(Y) ~ scale(X1) + scale(X2), data)\nmodel2\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = scale(Y) ~ scale(X1) + scale(X2), data = data)\n\nCoefficients:\n(Intercept)    scale(X1)    scale(X2)  \n -7.552e-16    4.792e-01    6.765e-01  \n```\n:::\n:::\n\n答：标准化回归方程为：$\\hat{y} = -7.552\\times 10^{-16} + 0.4792x_1 + 0.6765x_2$。\n\n#### 9. 求当$x_{01}=75$，$x_{02}=42$，$x_{03}=3.1$时的$\\hat{y}_0$，给定置信水平为95%，计算精确置信区间\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(model1, \n        newdata=data.frame(X1 = 75, X2 = 42),\n        se.fit=TRUE,\n        interval=\"confidence\",\n        level=.95)$fit\n```\n\n::: {.cell-output-stdout}\n```\n      fit      lwr      upr\n1 267.829 239.9677 295.6903\n```\n:::\n:::\n\n答：$\\hat{y}_0=267.829$，95%置信水平下的精确置信区间为：(239.97,295.69)。\n\n#### 10. 结合回归方程对问题做一些基本分析\n\n答：1> 由最终建立的回归方程：$\\hat{y}=-459.624+4.676x_1+8.971x_2$，当固定农业总产值，工业总产值每增加1亿元，货运总量大约将增加4.676万吨。相反同理。而居民非商品指出对货运总量没有显著线性影响。2> 由标准化回归方程：$\\hat{y}=-7.552\\times 10^{-16} + 0.4792x_1 + 0.6765x_2$，可知农业总产值对货运总量影响更大。",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": [],
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}