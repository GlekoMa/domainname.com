{
  "hash": "cc805208add864c9cca624d207c7e77b",
  "result": {
    "markdown": "---\ntitle: 习题2.14\nfig-height: 3\nfig-width: 5\n---\n\n> **题目：为了调查某广告对销售收入的影响，某商店记录了5个月的销售收入$y$（万元）和广告费用$x$（万元），数据如下表所示。**\n\n::: {.cell}\n\n```{.r .cell-code}\n# 读取数据\nlibrary(haven)\ndata = read_sav(\"data/xt2.14.sav\")\nhead(data)\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 5 × 2\n      x     y\n  <dbl> <dbl>\n1     1    10\n2     2    10\n3     3    20\n4     4    20\n5     5    40\n```\n:::\n:::\n\n#### 1. 画散点图\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(data=data, mapping=aes(x=x, y=y)) +\n    geom_point()\n```\n\n::: {.cell-output-display}\n![](xt2.14_files/figure-html/unnamed-chunk-2-1.png){width=480}\n:::\n:::\n\n#### 2. $x$与$y$之间是否大致呈线性关系\n\n*答：是。*\n\n#### 3. 用最小二乘估计求出回归方程\n\n::: {.cell}\n\n```{.r .cell-code}\n# 最小二乘法拟合回归模型\nmodel = lm(y ~ x, data=data)\nmodel\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ x, data = data)\n\nCoefficients:\n(Intercept)            x  \n         -1            7  \n```\n:::\n:::\n\n#### 4. 求回归标准误差$\\bar{\\sigma}$\n\n::: {.cell}\n\n```{.r .cell-code}\n# 查看summary结果\n# 其中Residual standard error即为Se（或称SEE）\nSummary = summary(model)\nSummary$sigma\n```\n\n::: {.cell-output-stdout}\n```\n[1] 6.055301\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 附：对lm对象使用summary函数将直接输出模型大部分信息\nsummary(model)\n```\n\n::: {.cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ x, data = data)\n\nResiduals:\n         1          2          3          4          5 \n 4.000e+00 -3.000e+00 -3.775e-15 -7.000e+00  6.000e+00 \nattr(,\"format.spss\")\n[1] \"F8.2\"\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)  \n(Intercept)   -1.000      6.351  -0.157   0.8849  \nx              7.000      1.915   3.656   0.0354 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.055 on 3 degrees of freedom\nMultiple R-squared:  0.8167,\tAdjusted R-squared:  0.7556 \nF-statistic: 13.36 on 1 and 3 DF,  p-value: 0.03535\n```\n:::\n:::\n\n#### 5. 给出$\\hat{\\beta}_0$与$\\hat{\\beta}_1$的置信度为95%的区间估计\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint(model)\n```\n\n::: {.cell-output-stdout}\n```\n                  2.5 %   97.5 %\n(Intercept) -21.2112485 19.21125\nx             0.9060793 13.09392\n```\n:::\n:::\n\n#### 6. 计算$x$与$y$的决定系数\n\n::: {.cell}\n\n```{.r .cell-code}\nSummary$r.squared\n```\n\n::: {.cell-output-stdout}\n```\n[1] 0.8166667\n```\n:::\n:::\n\n#### 7. 对回归方程做方差分析\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(model)\n```\n\n::: {.cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: y\n          Df Sum Sq Mean Sq F value  Pr(>F)  \nx          1    490  490.00  13.364 0.03535 *\nResiduals  3    110   36.67                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n#### 8. 做回归方差$\\beta_1$的显著性检验\n\n*答：由（7）中方差分析表，P值0.0354 < 0.05，显著性水平为5%的情况下拒绝原假设$H_0:\\beta_1 = 0$，即判定$\\beta_1$显著不为0。*\n\n#### 9. 做相关系数的显著性检验\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(data$x, data$y, method='pearson')$estimate[['cor']]\n```\n\n::: {.cell-output-stdout}\n```\n[1] 0.9036961\n```\n:::\n:::\n\n#### 10. 对回归方程作残差图并作相关分析\n\n::: {.cell}\n\n```{.r .cell-code}\n# 残差图\nggplot(model, aes(x=x, y=.resid)) + \n    geom_point() + \n    geom_hline(yintercept = 0) + \n    labs(y=\"Residuals\")\n```\n\n::: {.cell-output-display}\n![](xt2.14_files/figure-html/unnamed-chunk-10-1.png){width=480}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 计算内部学生化残差，然后检验异常值\nestd = rstandard(model)\nsum(abs(estd) > 3) # 大于3Sigma的数量，若为0则判定无异常值\n```\n\n::: {.cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 附：当传入一个线性回归模型作为data时，ggplot会默认对其进行加工\n# 藏而未现的真实数据框为fortify(model)\nhead(fortify(model))\n```\n\n::: {.cell-output-stdout}\n```\n   y x .hat   .sigma      .cooksd .fitted        .resid  .stdresid\n1 10 1  0.6 5.916080 8.181818e-01       6  4.000000e+00  1.0444659\n2 10 2  0.3 6.969321 7.513915e-02      13 -3.000000e+00 -0.5921565\n3 20 3  0.2 7.416198 6.071932e-32      20 -3.774758e-15  0.0000000\n4 20 4  0.3 4.472136 4.090909e-01      27 -7.000000e+00 -1.3816986\n5 40 5  0.6 3.162278 1.840909e+00      34  6.000000e+00  1.5666989\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 附：对lm对象使用plot函数将直接画出四幅图像\n# 详细解释参考：《R语言教程》李东风 回归诊断一节\n# 1. Residuals vs Fitted\n# 2. Normal QQ\n# 3. Scale-Location\n# 4. Residuals vs Leverage\nplot(model)\n```\n\n::: {.cell-output-display}\n![](xt2.14_files/figure-html/unnamed-chunk-13-1.png){width=480}\n:::\n\n::: {.cell-output-display}\n![](xt2.14_files/figure-html/unnamed-chunk-13-2.png){width=480}\n:::\n\n::: {.cell-output-display}\n![](xt2.14_files/figure-html/unnamed-chunk-13-3.png){width=480}\n:::\n\n::: {.cell-output-display}\n![](xt2.14_files/figure-html/unnamed-chunk-13-4.png){width=480}\n:::\n:::\n\n#### 11. 求当广告费用为4.2万元时，销售收入将达到多少，并给出置信度为95%的置信区间\n\n::: {.cell}\n\n```{.r .cell-code}\n# interval=\"predict\"计算因变量新值的区间预测\n# interval=\"confidence\"计算因变量新值的平均值的区间预测\npredict(model, \n        newdata=data.frame(x = 4.2),\n        se.fit=TRUE,\n        interval=\"predict\",\n        level=.95)$fit\n```\n\n::: {.cell-output-stdout}\n```\n   fit      lwr      upr\n1 28.4 6.059318 50.74068\n```\n:::\n:::\n",
    "supporting": [
      "xt2.14_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": [],
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}