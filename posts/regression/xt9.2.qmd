---
title: 习题9.2
fig-height: 3
fig-width: 5
description: 非线性回归
---

> **为了研究生产率与废料率之间的关系，记录数据如下表。请画出散点图，并根据散点图的趋势拟合适当的回归模型。**

```{r}
library(haven)
data = read_sav("data\\xt9.2.sav")
head(data)
```

**画散点图**

```{r}
library(ggplot2)
(p = ggplot(data, aes(X, Y)) + 
        geom_point())
```

**拟合二次曲线**

```{r}
model = lm(Y ~ I(X^2), data)
summary(model)
```

模型$R^2=0.954$，F检验的P值=0.0001563<0.05，回归方程显著，回归系数全部t检验通过。拟合效果较好。

**拟合效果展示**

```{r}
p + geom_smooth(method='lm',
                formula=y ~ I(x^2),
                se=FALSE)
```



