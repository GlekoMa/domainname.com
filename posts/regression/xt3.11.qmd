---
title: 习题3.11
fig-height: 3
fig-width: 5
description: 多元线性回归
---

> **题目：研究货运总量$y$（万吨）与工业总产值$x_1$（亿元）、农业总产值$x_2$（亿元）、居民非商品支出$x_3$（亿元）的关系。数据如下表所示。**

```{r}
# 课本数据有10行，数据集不知何故多出一行
library(haven)
data = read_sav("data/xt3.11.sav")[-11, ]
head(data)
```

#### 1. 计算出$y$，$x_1$，$x_2$，$x_3$的相关系数矩阵。

```{r}
cor(data)
```

#### 2. 求$y$关于$x_1$，$x_2$，$x_3$的三元线性方程

```{r}
model0 = lm(Y ~ X1 + X2 + X3, data)
model0
```

答：回归方程为：$\hat{y} = -348.28+3.754x_1 + 7.101x_2 + 12.447x_3$。

#### 3. 对所求得的方程做拟合优度检验

```{r}
Sm0 = summary(model0)
Sm0$r.squared
```

答：$R^2=0.8055$，接近1，说明方程拟合程度较好。

#### 4. 对回归方程做显著性检验

```{r}
# $运算符仅能提取F检验值，而未找到提取F检验P值的办法
# 其位于summary函数输出的最后一行
Sm0
```

答：F检验的P值=0.01487<0.05，说明回归方程显著。

#### 5. 对每一个回归系数做显著性检验

```{r}
Sm0$coefficients
```

答：对各回归系数t检验中，$x_1$、$x_3$相应P值<0.5。在显著性水平5%情况下拒绝原假设，说明$x_1$、$x_3$对预测值$y$没有显著影响。

#### 6. 如果有的回归系数没通过显著性检验，将其剔除，重新建立回归方程，再做方程的显著性检验和回归系数的显著性检验

```{r}
# 由上题结果P值大小，剔除X3
model1 = lm(Y ~ X1 + X2, data)
Sm1 = summary(model1)
Sm1
```

答：剔除$x_3$后，重新建立的回归方程为：$\hat{y}=-459.624+4.676x_1+8.971x_2$。各回归系数相应P值皆小于0.05，即都通过显著性检验。

#### 7. 求出每一个回归系数的置信水平为95%的置信区间

```{r}
confint(model1)
```

答：$\hat{\beta}_0$、$\hat{\beta}_1$、$\hat{\beta}_2$的95%置信区间分别为：(-821.55, -97.70)、(0.38, 8.97)和(3.13,14.81)。

#### 8. 求标准化回归方程

```{r}
model2 = lm(scale(Y) ~ scale(X1) + scale(X2), data)
model2
```

答：标准化回归方程为：$\hat{y} = -7.552\times 10^{-16} + 0.4792x_1 + 0.6765x_2$。

#### 9. 求当$x_{01}=75$，$x_{02}=42$，$x_{03}=3.1$时的$\hat{y}_0$，给定置信水平为95%，计算精确置信区间

```{r}
predict(model1, 
        newdata=data.frame(X1 = 75, X2 = 42),
        se.fit=TRUE,
        interval="confidence",
        level=.95)$fit
```

答：$\hat{y}_0=267.829$，95%置信水平下的精确置信区间为：(239.97,295.69)。

#### 10. 结合回归方程对问题做一些基本分析

答：1> 由最终建立的回归方程：$\hat{y}=-459.624+4.676x_1+8.971x_2$，当固定农业总产值，工业总产值每增加1亿元，货运总量大约将增加4.676万吨。相反同理。而居民非商品指出对货运总量没有显著线性影响。2> 由标准化回归方程：$\hat{y}=-7.552\times 10^{-16} + 0.4792x_1 + 0.6765x_2$，可知农业总产值对货运总量影响更大。